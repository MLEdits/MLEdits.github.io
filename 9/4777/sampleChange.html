<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
            if self.do_ten_crop:
                n = y.shape[0] // 10
                y_shape = y.shape[1:]
                <a id="change">y = y.reshape((n, 10) + y_shape)</a>
                y = self.xp.sum(y, axis=1) / 10
        <a id="change">return cuda.to_cpu(y)</a>


def _max_pooling_2d(x):
    return F.max_pooling_2d(x, ksize=2)</code></pre><h3>After Change</h3><pre><code class='java'>
                    activation = self._gather_ten_crop(activation)
                activations[name] = cuda.to_cpu(activations)
        else:
            <a id="change">activations = cuda.to_cpu(activations.data)</a>
            if self.do_ten_crop:
                <a id="change">activations = self._gather_ten_crop(activations)</a>

        <a id="change">return activations</a>

    def _gather_ten_crop(self, y):
        xp = chainer.cuda.get_array_module(y)
        n = y.shape[0] // 10</code></pre>