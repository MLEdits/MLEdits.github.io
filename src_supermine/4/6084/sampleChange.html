<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        &#47&#47 for position [0, 1, 2, ..., max_position_embeddings-1], and the current
        &#47&#47 sequence has positions [0, 1, 2, ... seq_length-1], so we can just
        &#47&#47 perform a slice.
        <a id="change">if seq_length &lt; max_position_embeddings:
            position_embeddings = tf.slice(full_position_embeddings, [0, 0],
                                           [seq_length, -1])
        else:
            position_embeddings = full_position_embeddings

       </a> num_dims = len(output.shape.as_list())

        &#47&#47 Only the last two dimensions are relevant (`seq_length` and `width`), so
        &#47&#47 we broadcast among the first dimensions, which is typically just</code></pre><h3>After Change</h3><pre><code class='java'>
        &#47&#47 for position [0, 1, 2, ..., max_position_embeddings-1], and the current
        &#47&#47 sequence has positions [0, 1, 2, ... seq_length-1], so we can just
        &#47&#47 perform a slice.
        position_embeddings = <a id="change">tf.cond(seq_length &lt; max_position_embeddings,
                                      lambda: tf.slice(full_position_embeddings, [0, 0], [seq_length, -1]),
                                      lambda: full_position_embeddings)</a>
        &#47&#47 if seq_length &lt; max_position_embeddings:
        &#47&#47     position_embeddings = tf.slice(full_position_embeddings, [0, 0],
        &#47&#47                                    [seq_length, -1])
        &#47&#47 else:</code></pre>