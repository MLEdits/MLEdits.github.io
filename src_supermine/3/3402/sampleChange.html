<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
    &#47&#47 channal is also divided into serveral groups and each group
    &#47&#47 filter may have different input channel indexes.
    input_step = int(conv.in_channels / conv.groups)
    in_channels_group = <a id="change">int(in_channels / conv.groups)</a>
    filter_step = int(out_channels / conv.groups)
    if mask.input_mask is not None:
        for groupid in range(conv.groups):
            start = groupid * input_step</code></pre><h3>After Change</h3><pre><code class='java'>
    groups = conv.groups
    if conv.in_channels == conv.out_channels == conv.groups:
        &#47&#47 remove groups for depthwise layers
        <a id="change">assert in_channels == out_channels</a>
        groups = in_channels
    _logger.debug("replace conv2d %s with in_channels: %d, out_channels: %d", mask.module_name, in_channels, out_channels)
    new_conv = torch.nn.Conv2d(in_channels=in_channels,
                               out_channels=out_channels,</code></pre>