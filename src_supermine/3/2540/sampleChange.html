<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        return Estimator(build_model_fn(_graph_tmp_file_), config=RunConfig(session_config=config))

    def run(self):
        <a id="change">print(&quot________&quot)</a>
        os.environ[&quotCUDA_VISIBLE_DEVICES&quot] = &quot6&quot

        import tensorflow as tf
        from tensorflow.python.client import device_lib</code></pre><h3>After Change</h3><pre><code class='java'>
        receiver = context.socket(zmq.PULL)
        receiver.connect(self.worker_address)

        <a id="change">sink = context.socket(zmq.PUSH)</a>
        sink.connect(self.sink_address)
        for r in estimator.predict(self.input_fn_builder(receiver), yield_single_examples=False):
            send_ndarray(sink, r[&quotclient_id&quot], r[&quotencodes&quot])
            self.logger.info(&quotjob done\tsize: %s\tclient: %s&quot % (r[&quotencodes&quot].shape, r[&quotclient_id&quot]))

        receiver.close()
        <a id="change">sink.close()</a>
        context.term()
        self.logger.info(&quotterminated!&quot)

    def input_fn_builder(self, worker):</code></pre>