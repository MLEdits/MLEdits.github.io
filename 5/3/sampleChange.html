<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3></h3><h3>Before Change</h3><pre><code class='java'>
        batch2, t_len2, d2 = value.size()
        batch3, q_len, d3 = query.size()
        assert batch == batch2
        <a id="change">assert batch == batch3</a>
        assert t_len == t_len2
        assert d == self.d_model

        def shape_projection(x):</code></pre><h3>After Change</h3><pre><code class='java'>
        aeq(batch, batch_)
        aeq(d, d_)
        aeq(self.d_model % 8, 0)
        <a id="change">if mask is not None:
            batch_, q_len_, k_len_ = mask.size()
            aeq(batch_, batch)
            aeq(k_len_, k_len)
            aeq(q_len_ == q_len)
        &#47&#47 END CHECKS

       </a> def shape_projection(x):
            b, l, d = x.size()
            return x.view(b, l, self.heads, self.d_k).transpose(1, 2) \
                    .contiguous().view(b * self.heads, l, self.d_k)</code></pre>